branches:
  only: deploy

language: node_js

install:
  - git submodule -q update --init
  - npm install

script:
  - set -e
  - npm test
  - node ./scripts/prebuild

jobs:
  include:
    - os: windows
      language: cpp
      install:
        - choco install visualstudio2019buildtools --package-parameters "--add Microsoft.VisualStudio.Component.VC.Tools.x86.x64"
      env:
        - MSBUILD_PATH="C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\MSBuild\Current\Bin"
    - os: osx
      osx_image: xcode12.5
    - os: linux
      dist: bionic

node_js:
  - '16'
